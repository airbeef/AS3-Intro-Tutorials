package {	import flash.display.MovieClip;	import flash.events.Event;	import flash.events.MouseEvent;	public class Player extends MovieClip	{		private const EASING:Number = 0.12;				//variables		private var _angle:Number;		private var _direction:Number;		private var _shotFired:Boolean;		public function Player()		{			//Initialize variables			_angle = 0;			_direction = 0;			_shotFired = false;			//Add listeners			stage.addEventListener(MouseEvent.MOUSE_DOWN, onMouseDown);			stage.addEventListener(MouseEvent.MOUSE_UP, onMouseUp);			addEventListener(Event.ENTER_FRAME, onEnterFrame);		}		private function onMouseDown(event:MouseEvent):void		{			if (! _shotFired)			{				shootBullet();				_shotFired = true;			}		}		private function onMouseUp(event:MouseEvent):void		{			_shotFired = false;		}		private function onEnterFrame(event:Event):void		{			_angle = Math.atan2(y - stage.mouseY, x - stage.mouseX);						//Calculate the distance to the mouse			var dx:Number = stage.mouseX - this.x - wand.x;			var dy:Number = stage.mouseY - this.y - wand.y;			//Unoptimized:			//var distance:Number = Math.sqrt(dx * dx + dy * dy);			//Optimized:			var distanceSquared:Number = (dx * dx + dy * dy);			//Move the player if the mouse is more than 50 pixels away			//Unoptimized:			//if (distance >= 1)			//Optimized. 1 squared (1x1) is still just 1):			if (distanceSquared >= 1)			{				x += dx * EASING;				y += dy * EASING;			}			//Move wand			var radius:int = -50;			wand.x = radius * Math.cos(_angle);			wand.y = radius * Math.sin(_angle);		}		private function shootBullet():void		{			//Bullet's velocity			var bullet_Vx:Number = Math.cos(_angle) * -10;			var bullet_Vy:Number = Math.sin(_angle) * -10;			//Bullet's start position			var radius:int = -75;			var bullet_StartX:Number = x + radius * Math.cos(_angle);			var bullet_StartY:Number = y + radius * Math.sin(_angle);			//Create bullet instance and add it to the stage			var bullet:Bullet = new Bullet(bullet_Vx, bullet_Vy, bullet_StartX, bullet_StartY, "star");			parent.addChild(bullet);		}	}}